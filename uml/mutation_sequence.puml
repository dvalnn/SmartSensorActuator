@startuml
!pragma teoz true
skinparam style strictuml

actor consumer

participant "End Node" as iotdev
participant "Edge Node" as node
database "Thing DB" as db
database "App Storage" as store

activate consumer
consumer -> node : device adaptation request

activate node
    
    node -> db : get new TM
    node -> store : get TM application code

    node -> node : update device TD

    node -> iotdev : upload code
    activate iotdev
        iotdev --> node : ack
        iotdev -> iotdev : run new app
    deactivate iotdev

return provide updated TD

consumer -> consumer : learn new API\nfrom TD

@enduml 
